#parse("/velocity/layout.vm")
#@mainLayout()
    #if($show && $productionCompany && $actors)

	<div class="container">

		<h1 class="header">$show.showTitle - ($show.year)</h1>

		<img class="jumbo" src="$show.image" alt="$show.showTitle">

		<div class="specs right">
			<h3>Specifications</h3>
			<p>Runtime: $show.length hrs</p>
			<p>Genre: $show.genre</p>
			<p>Productions Company: $productionCompany.name</p>
			#if($currentUser)
			<form id="ratingStar" method="post">
				<i class="fa fa-star" data-index="0"></i>
				<i class="fa fa-star" data-index="1"></i>
				<i class="fa fa-star" data-index="2"></i>
				<i class="fa fa-star" data-index="3"></i>
				<i class="fa fa-star" data-index="4"></i>
				<input type="hidden" id="ratingNumber" name="rating">
				<input type="hidden" id="showId" name="showId" value=$show.showid>
				<input type="submit" value="Rate">				
			</form>
			#else
				<h3>Login to rate Shows<h3>
			#end
		</div>

	</div>

	<div class="container">
		<h1 class="header">Cast</h1>
		<table>
			<thead>
				<td>Cast Member</td>
				<td>Character</td>
				<td>Role</td>
				<td>Start Year</td>
			</thead>
			#foreach($actor in $actors)
				<tr>
					<td>$actor.person</td>
					<td>$actor.character</td>
					<td>$actor.role</td>
					<td>$actor.startYear</td>
				</tr>
			#end

		</table>
	</div>

	<div class="container">
		<h1 class="header">User Reviews</h1>
	</div>

    	
    #else
   		<h1>Sorry we are unable to find the show that you are looking for</h1>
    #end
    
    <script src="https://code.jquery.com/jquery-3.5.0.min.js" integrity="sha256-xNzN2a4ltkB44Mc/Jz3pT4iU1cmeR0FkXs4pru/JxaQ=" crossorigin="anonymous"></script>
	<script>
		var ratedIndex = -1;
		var actualRating = 0;
		
		$(document).ready(function() {
			resetStars();
			
			$('.fa-star').on('click', function () {
				ratedIndex = parseInt($(this).data('index'));
				actualRating = ratedIndex;
				actualRating++;
				console.log(ratedIndex);
				document.getElementById("ratingNumber").value = actualRating;
			});
			
			$('.fa-star').mouseover(function () {
				resetStars();
				
				var currDataIndex = parseInt($(this).data('index'));
				
				for(var i=0; i <= currDataIndex; i++)
					$('.fa-star:eq('+i+')').css('color', '#ffdf00');
			});
		});
		
		$('.fa-star').mouseleave(function () {
				resetStars();
				
				if(ratedIndex != -1){
					for(var i=0; i <=  ratedIndex; i++){
						$('.fa-star:eq('+i+')').css('color', '#ffdf00');
					}
				}
			});
			
		function resetStars(){
		$('.fa-star').css('color', 'black');
		}
		
	</script>
#end
